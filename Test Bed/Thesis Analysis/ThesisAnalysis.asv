% output params
writePath = 'E:\Thesis Results\Results Small Test.xls';
sheetName = 'Parameter Optimization';

% general params
catheterMaskRadius = 5;

% Set-up base for the analysis
base = AnalysisRun;

base.catheterCoordsFile = 'F:\Thesis Recon Data\Gel 4-2\Catheter Coords.mat';

base.usedCatheterReject = false;

% Control Analysis
control = base;
control.gelName = 'Gel 4-1';
control.reconAlgorithm = 'FDK';       
control.readPath = 'F:\Thesis Recon Data\Gel 4-1\Gel 4-1_HR.vff';

% FDK Comparison
fdkComp = base;
fdkComp.gelName = 'Gel 4-2';
fdkComp.reconAlgorithm = 'FDK';       
fdkComp.readPath = 'F:\Thesis Recon Data\Gel 4-2\Gel 4-2_HR.vff';

% OSC-TV No Flood Field
osctvBase = base;
osctvBase.gelName = 'Gel 4-2';
osctvBase.reconAlgorithm = 'OSC-TV'; 
osctvBase.reconNumberStart = 1;  
osctvBase.numIterList = {'10', '15'};
osctvBase.numSubsetsValues = 


osctvNoFF.readPath = 'E:\Data Files\Git Repos\Local Gyrfalcon Data\Imaging Scan Runs\Optical CT Imaging Scan Run (Gel 4-2)\';
osctvNoFF.usedFloodFields = false;  
osctvNoFF.numIterationsValues = {'15'};
osctvNoFF.numSubsetsValues = {'[205,41]'};

numIterList = {'10', '15'};

subsetsList = {...
    '[26 2]',...
    '[51 3]',...
    '[103 6]',...
    '[205 13]',...
    '[205 41]'};

cList = {0.001, 0.005, 0.01, 0.05, 0.1};


osctvNoFF.cValues = {'0.001', '0.005', '0.01', '0.05', '0.1'};

% OSC-TV No Flood Field
osctvFF = base;
osctvFF.gelName = 'Gel 4-2';
osctvFF.reconAlgorithm = 'OSC-TV';       
osctvFF.readPath = 'E:\Data Files\Git Repos\Local Gyrfalcon Data\Imaging Scan Runs\Optical CT Imaging Scan Run (Gel 4-2 FF-R)\';
osctvFF.usedFloodFields = true;
osctvFF.reconNumberStart = 46;    
osctvFF.numIterationsValues = {'15'};
osctvFF.numSubsetsValues = {'[205,41]'};
osctvFF.cValues = {'0.001', '0.005', '0.01', '0.05', '0.1'};
  
% *********
% ** RUN **
% *********

crunchParameterOptimizationMetrics(...
    {control, fdkComp, osctvNoFF, osctvFF},...
    catheterMaskRadius,...
    writePath, sheetName);