<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line">function  f = minimizeTV2(f, tvConstant, nIterTV)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line">    for i=1:nIterTV</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">        f_grad = tvGradient(f);</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">        norm = sqrt(sum(sum(sum(f_grad.^2))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">        f = f - (tvConstant .* f_grad / norm);</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    end</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">end</span></span>
</pre>
</div>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S12T3U48">f_grad</span> = tvGradient(<span class="var type1" id="S13T1U51">f</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T28:U3"><span class="var type1" id="S14T28U54">dims</span> = <span class="mxinfo " id="T28:U5">size(<span class="var type1" id="S13T1U57">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T2:U7"><span class="var type1" id="S16T2U60">e</span> = <span class="mxinfo " id="T2:U9">10^-8</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T3:U10"><span class="var type1" id="S12T3U67">f_grad</span> = <span class="mxinfo " id="T3:U12">zeros(<span class="var type1" id="S14T28U70">dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T18:U14"><span class="var type1" id="S18T18U73">s</span> = <span class="mxinfo " id="T18:U16">2:<span class="mxinfo " id="T2:U17"><span class="mxinfo " id="T2:U18"><span class="var type1" id="S14T28U78">dims</span>(<span class="mxinfo " id="T9:U20">1</span>)</span>-<span class="mxinfo " id="T2:U21">1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T18:U22"><span class="var type1" id="S19T18U83">t</span> = <span class="mxinfo " id="T18:U24">2:<span class="mxinfo " id="T2:U25"><span class="mxinfo " id="T2:U26"><span class="var type1" id="S14T28U88">dims</span>(<span class="mxinfo " id="T9:U28">2</span>)</span>-<span class="mxinfo " id="T2:U29">1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T18:U30"><span class="var type1" id="S20T18U93">u</span> = <span class="mxinfo " id="T18:U32">2:<span class="mxinfo " id="T2:U33"><span class="mxinfo " id="T2:U34"><span class="var type1" id="S14T28U98">dims</span>(<span class="mxinfo " id="T9:U36">3</span>)</span>-<span class="mxinfo " id="T2:U37">1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T3:U38"><span class="mxinfo " id="T3:U39"><span class="var type1" id="S12T3U104">f_grad</span>(<span class="mxinfo " id="T18:U41"><span class="mxinfo " id="T2:U42">2</span>:<span class="mxinfo " id="T2:U43"><span class="mxinfo " id="T2:U44">end</span>-<span class="mxinfo " id="T2:U45">1</span></span></span>, <span class="mxinfo " id="T18:U46"><span class="mxinfo " id="T2:U47">2</span>:<span class="mxinfo " id="T2:U48"><span class="mxinfo " id="T2:U49">end</span>-<span class="mxinfo " id="T2:U50">1</span></span></span>, <span class="mxinfo " id="T18:U51"><span class="mxinfo " id="T2:U52">2</span>:<span class="mxinfo " id="T2:U53"><span class="mxinfo " id="T2:U54">end</span>-<span class="mxinfo " id="T2:U55">1</span></span></span>)</span> = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">        <span class="mxinfo " id="T1:U56"><span class="mxinfo " id="T1:U57"><span class="mxinfo " id="T1:U58">(<span class="mxinfo " id="T1:U59">(<span class="mxinfo " id="T1:U60"><span class="mxinfo " id="T1:U61">(<span class="mxinfo " id="T1:U62"><span class="mxinfo " id="T1:U63"><span class="var type1" id="S13T1U134">f</span>(<span class="var type1" id="S18T18U135">s</span>,<span class="var type1" id="S19T18U136">t</span>,<span class="var type1" id="S20T18U137">u</span>)</span> - <span class="mxinfo " id="T1:U68"><span class="var type1" id="S13T1U139">f</span>(<span class="mxinfo " id="T18:U70"><span class="var type1" id="S18T18U141">s</span>-<span class="mxinfo " id="T2:U72">1</span></span>,<span class="var type1" id="S19T18U143">t</span>,<span class="var type1" id="S20T18U144">u</span>)</span></span>) + (<span class="mxinfo " id="T1:U75"><span class="mxinfo " id="T1:U76"><span class="var type1" id="S13T1U148">f</span>(<span class="var type1" id="S18T18U149">s</span>,<span class="var type1" id="S19T18U150">t</span>,<span class="var type1" id="S20T18U151">u</span>)</span> - <span class="mxinfo " id="T1:U81"><span class="var type1" id="S13T1U153">f</span>(<span class="var type1" id="S18T18U154">s</span>,<span class="mxinfo " id="T18:U84"><span class="var type1" id="S19T18U156">t</span>-<span class="mxinfo " id="T2:U86">1</span></span>,<span class="var type1" id="S20T18U158">u</span>)</span></span>)</span> + (<span class="mxinfo " id="T1:U88"><span class="mxinfo " id="T1:U89"><span class="var type1" id="S13T1U162">f</span>(<span class="var type1" id="S18T18U163">s</span>,<span class="var type1" id="S19T18U164">t</span>,<span class="var type1" id="S20T18U165">u</span>)</span> - <span class="mxinfo " id="T1:U94"><span class="var type1" id="S13T1U167">f</span>(<span class="var type1" id="S18T18U168">s</span>,<span class="var type1" id="S19T18U169">t</span>,<span class="mxinfo " id="T18:U98"><span class="var type1" id="S20T18U171">u</span>-<span class="mxinfo " id="T2:U100">1</span></span>)</span></span>)</span>) ./<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo " id="T1:U101">sqrt( <span class="mxinfo " id="T1:U102"><span class="mxinfo " id="T1:U103"><span class="mxinfo " id="T1:U104"><span class="var type1" id="S16T2U178">e</span> +  <span class="mxinfo " id="T1:U106">(<span class="mxinfo " id="T1:U107"><span class="mxinfo " id="T1:U108"><span class="var type1" id="S13T1U183">f</span>(<span class="var type1" id="S18T18U184">s</span>,<span class="var type1" id="S19T18U185">t</span>,<span class="var type1" id="S20T18U186">u</span>)</span> - <span class="mxinfo " id="T1:U113"><span class="var type1" id="S13T1U188">f</span>(<span class="mxinfo " id="T18:U115"><span class="var type1" id="S18T18U190">s</span>-<span class="mxinfo " id="T2:U117">1</span></span>,<span class="var type1" id="S19T18U192">t</span>,<span class="var type1" id="S20T18U193">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U120">(<span class="mxinfo " id="T1:U121"><span class="mxinfo " id="T1:U122"><span class="var type1" id="S13T1U199">f</span>(<span class="var type1" id="S18T18U200">s</span>,<span class="var type1" id="S19T18U201">t</span>,<span class="var type1" id="S20T18U202">u</span>)</span> - <span class="mxinfo " id="T1:U127"><span class="var type1" id="S13T1U204">f</span>(<span class="var type1" id="S18T18U205">s</span>,<span class="mxinfo " id="T18:U130"><span class="var type1" id="S19T18U207">t</span>-<span class="mxinfo " id="T2:U132">1</span></span>,<span class="var type1" id="S20T18U209">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U134">(<span class="mxinfo " id="T1:U135"><span class="mxinfo " id="T1:U136"><span class="var type1" id="S13T1U215">f</span>(<span class="var type1" id="S18T18U216">s</span>,<span class="var type1" id="S19T18U217">t</span>,<span class="var type1" id="S20T18U218">u</span>)</span> - <span class="mxinfo " id="T1:U141"><span class="var type1" id="S13T1U220">f</span>(<span class="var type1" id="S18T18U221">s</span>,<span class="var type1" id="S19T18U222">t</span>,<span class="mxinfo " id="T18:U145"><span class="var type1" id="S20T18U224">u</span>-<span class="mxinfo " id="T2:U147">1</span></span>)</span></span>).^2</span></span> )</span></span>) - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">        ( <span class="mxinfo " id="T1:U148">(<span class="mxinfo " id="T1:U149"><span class="mxinfo " id="T1:U150"><span class="var type1" id="S13T1U232">f</span>(<span class="mxinfo " id="T18:U152"><span class="var type1" id="S18T18U234">s</span>+<span class="mxinfo " id="T2:U154">1</span></span>,<span class="var type1" id="S19T18U236">t</span>,<span class="var type1" id="S20T18U237">u</span>)</span>-<span class="mxinfo " id="T1:U157"><span class="var type1" id="S13T1U239">f</span>(<span class="var type1" id="S18T18U240">s</span>,<span class="var type1" id="S19T18U241">t</span>,<span class="var type1" id="S20T18U242">u</span>)</span></span>) ./ <span class="mxinfo " id="T1:U162">sqrt(<span class="mxinfo " id="T1:U163"><span class="mxinfo " id="T1:U164"><span class="mxinfo " id="T1:U165"><span class="var type1" id="S16T2U248">e</span> + <span class="mxinfo " id="T1:U167">(<span class="mxinfo " id="T1:U168"><span class="mxinfo " id="T1:U169"><span class="var type1" id="S13T1U253">f</span>(<span class="mxinfo " id="T18:U171"><span class="var type1" id="S18T18U255">s</span>+<span class="mxinfo " id="T2:U173">1</span></span>,<span class="var type1" id="S19T18U257">t</span>,<span class="var type1" id="S20T18U258">u</span>)</span>-<span class="mxinfo " id="T1:U176"><span class="var type1" id="S13T1U260">f</span>(<span class="var type1" id="S18T18U261">s</span>,<span class="var type1" id="S19T18U262">t</span>,<span class="var type1" id="S20T18U263">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U181">(<span class="mxinfo " id="T1:U182"><span class="mxinfo " id="T1:U183"><span class="var type1" id="S13T1U269">f</span>(<span class="mxinfo " id="T18:U185"><span class="var type1" id="S18T18U271">s</span>+<span class="mxinfo " id="T2:U187">1</span></span>,<span class="var type1" id="S19T18U273">t</span>,<span class="var type1" id="S20T18U274">u</span>)</span>-<span class="mxinfo " id="T1:U190"><span class="var type1" id="S13T1U276">f</span>(<span class="mxinfo " id="T18:U192"><span class="var type1" id="S18T18U278">s</span>+<span class="mxinfo " id="T2:U194">1</span></span>,<span class="mxinfo " id="T18:U195"><span class="var type1" id="S19T18U281">t</span>-<span class="mxinfo " id="T2:U197">1</span></span>,<span class="var type1" id="S20T18U283">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U199">(<span class="mxinfo " id="T1:U200"><span class="mxinfo " id="T1:U201"><span class="var type1" id="S13T1U289">f</span>(<span class="mxinfo " id="T18:U203"><span class="var type1" id="S18T18U291">s</span>+<span class="mxinfo " id="T2:U205">1</span></span>,<span class="var type1" id="S19T18U293">t</span>,<span class="var type1" id="S20T18U294">u</span>)</span>-<span class="mxinfo " id="T1:U208"><span class="var type1" id="S13T1U296">f</span>(<span class="mxinfo " id="T18:U210"><span class="var type1" id="S18T18U298">s</span>+<span class="mxinfo " id="T2:U212">1</span></span>,<span class="var type1" id="S19T18U300">t</span>,<span class="mxinfo " id="T18:U214"><span class="var type1" id="S20T18U302">u</span>-<span class="mxinfo " id="T2:U216">1</span></span>)</span></span>).^2</span></span> )</span></span> )</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">        ( <span class="mxinfo " id="T1:U217">(<span class="mxinfo " id="T1:U218"><span class="mxinfo " id="T1:U219"><span class="var type1" id="S13T1U310">f</span>(<span class="var type1" id="S18T18U311">s</span>,<span class="mxinfo " id="T18:U222"><span class="var type1" id="S19T18U313">t</span>+<span class="mxinfo " id="T2:U224">1</span></span>,<span class="var type1" id="S20T18U315">u</span>)</span>-<span class="mxinfo " id="T1:U226"><span class="var type1" id="S13T1U317">f</span>(<span class="var type1" id="S18T18U318">s</span>,<span class="var type1" id="S19T18U319">t</span>,<span class="var type1" id="S20T18U320">u</span>)</span></span>) ./ <span class="mxinfo " id="T1:U231">sqrt(<span class="mxinfo " id="T1:U232"><span class="mxinfo " id="T1:U233"><span class="mxinfo " id="T1:U234"><span class="var type1" id="S16T2U326">e</span> + <span class="mxinfo " id="T1:U236">(<span class="mxinfo " id="T1:U237"><span class="mxinfo " id="T1:U238"><span class="var type1" id="S13T1U331">f</span>(<span class="var type1" id="S18T18U332">s</span>,<span class="mxinfo " id="T18:U241"><span class="var type1" id="S19T18U334">t</span>+<span class="mxinfo " id="T2:U243">1</span></span>,<span class="var type1" id="S20T18U336">u</span>)</span>-<span class="mxinfo " id="T1:U245"><span class="var type1" id="S13T1U338">f</span>(<span class="var type1" id="S18T18U339">s</span>,<span class="var type1" id="S19T18U340">t</span>,<span class="var type1" id="S20T18U341">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U250">(<span class="mxinfo " id="T1:U251"><span class="mxinfo " id="T1:U252"><span class="var type1" id="S13T1U347">f</span>(<span class="var type1" id="S18T18U348">s</span>,<span class="mxinfo " id="T18:U255"><span class="var type1" id="S19T18U350">t</span>+<span class="mxinfo " id="T2:U257">1</span></span>,<span class="var type1" id="S20T18U352">u</span>)</span>-<span class="mxinfo " id="T1:U259"><span class="var type1" id="S13T1U354">f</span>(<span class="mxinfo " id="T18:U261"><span class="var type1" id="S18T18U356">s</span>-<span class="mxinfo " id="T2:U263">1</span></span>,<span class="mxinfo " id="T18:U264"><span class="var type1" id="S19T18U359">t</span>+<span class="mxinfo " id="T2:U266">1</span></span>,<span class="var type1" id="S20T18U361">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U268">(<span class="mxinfo " id="T1:U269"><span class="mxinfo " id="T1:U270"><span class="var type1" id="S13T1U367">f</span>(<span class="var type1" id="S18T18U368">s</span>,<span class="mxinfo " id="T18:U273"><span class="var type1" id="S19T18U370">t</span>+<span class="mxinfo " id="T2:U275">1</span></span>,<span class="var type1" id="S20T18U372">u</span>)</span>-<span class="mxinfo " id="T1:U277"><span class="var type1" id="S13T1U374">f</span>(<span class="var type1" id="S18T18U375">s</span>,<span class="mxinfo " id="T18:U280"><span class="var type1" id="S19T18U377">t</span>+<span class="mxinfo " id="T2:U282">1</span></span>,<span class="mxinfo " id="T18:U283"><span class="var type1" id="S20T18U380">u</span>-<span class="mxinfo " id="T2:U285">1</span></span>)</span></span>).^2</span></span> )</span></span> )</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">        ( <span class="mxinfo " id="T1:U286">(<span class="mxinfo " id="T1:U287"><span class="mxinfo " id="T1:U288"><span class="var type1" id="S13T1U388">f</span>(<span class="var type1" id="S18T18U389">s</span>,<span class="var type1" id="S19T18U390">t</span>,<span class="mxinfo " id="T18:U292"><span class="var type1" id="S20T18U392">u</span>+<span class="mxinfo " id="T2:U294">1</span></span>)</span>-<span class="mxinfo " id="T1:U295"><span class="var type1" id="S13T1U395">f</span>(<span class="var type1" id="S18T18U396">s</span>,<span class="var type1" id="S19T18U397">t</span>,<span class="var type1" id="S20T18U398">u</span>)</span></span>) ./ <span class="mxinfo " id="T1:U300">sqrt(<span class="mxinfo " id="T1:U301"><span class="mxinfo " id="T1:U302"><span class="mxinfo " id="T1:U303"><span class="var type1" id="S16T2U404">e</span> + <span class="mxinfo " id="T1:U305">(<span class="mxinfo " id="T1:U306"><span class="mxinfo " id="T1:U307"><span class="var type1" id="S13T1U409">f</span>(<span class="var type1" id="S18T18U410">s</span>,<span class="var type1" id="S19T18U411">t</span>,<span class="mxinfo " id="T18:U311"><span class="var type1" id="S20T18U413">u</span>+<span class="mxinfo " id="T2:U313">1</span></span>)</span>-<span class="mxinfo " id="T1:U314"><span class="var type1" id="S13T1U416">f</span>(<span class="var type1" id="S18T18U417">s</span>,<span class="var type1" id="S19T18U418">t</span>,<span class="var type1" id="S20T18U419">u</span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U319">(<span class="mxinfo " id="T1:U320"><span class="mxinfo " id="T1:U321"><span class="var type1" id="S13T1U425">f</span>(<span class="var type1" id="S18T18U426">s</span>,<span class="var type1" id="S19T18U427">t</span>,<span class="mxinfo " id="T18:U325"><span class="var type1" id="S20T18U429">u</span>+<span class="mxinfo " id="T2:U327">1</span></span>)</span>-<span class="mxinfo " id="T1:U328"><span class="var type1" id="S13T1U432">f</span>(<span class="mxinfo " id="T18:U330"><span class="var type1" id="S18T18U434">s</span>-<span class="mxinfo " id="T2:U332">1</span></span>,<span class="var type1" id="S19T18U436">t</span>,<span class="mxinfo " id="T18:U334"><span class="var type1" id="S20T18U438">u</span>+<span class="mxinfo " id="T2:U336">1</span></span>)</span></span>).^2</span></span> + <span class="mxinfo " id="T1:U337">(<span class="mxinfo " id="T1:U338"><span class="mxinfo " id="T1:U339"><span class="var type1" id="S13T1U445">f</span>(<span class="var type1" id="S18T18U446">s</span>,<span class="var type1" id="S19T18U447">t</span>,<span class="mxinfo " id="T18:U343"><span class="var type1" id="S20T18U449">u</span>+<span class="mxinfo " id="T2:U345">1</span></span>)</span>-<span class="mxinfo " id="T1:U346"><span class="var type1" id="S13T1U452">f</span>(<span class="var type1" id="S18T18U453">s</span>,<span class="mxinfo " id="T18:U349"><span class="var type1" id="S19T18U455">t</span>-<span class="mxinfo " id="T2:U351">1</span></span>,<span class="mxinfo " id="T18:U352"><span class="var type1" id="S20T18U458">u</span>+<span class="mxinfo " id="T2:U354">1</span></span>)</span></span>).^2</span></span> )</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">          </span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"></span></span>
</pre>
</body>
</html>
